
import React from 'react';
import { ArrowRight, ArrowLeft, ArrowUp, ArrowDown, Repeat, Play, Brush, Split, CornerDownRight, GitBranch, GitMerge, Flag } from 'lucide-react';
import { BlockType, BlockCategory, BLOCK_DEFINITIONS } from '../types';

interface BlockIconProps {
  type: BlockType;
  className?: string;
  showLabel?: boolean;
}

export const BlockIcon: React.FC<BlockIconProps> = ({ type, className = "", showLabel = true }) => {
  const def = BLOCK_DEFINITIONS[type];
  
  // Colors based on category (Scratch-inspired)
  const categoryColors = {
    [BlockCategory.MOTION]: "bg-blue-500 border-blue-700 shadow-blue-900",
    [BlockCategory.CONTROL]: "bg-orange-500 border-orange-700 shadow-orange-900",
    [BlockCategory.ACTION]: "bg-purple-500 border-purple-700 shadow-purple-900",
    [BlockCategory.EVENT]: "bg-yellow-400 border-yellow-600 shadow-yellow-800 text-yellow-900",
    [BlockCategory.DECISION]: "bg-teal-500 border-teal-700 shadow-teal-900",
  };

  const colorClass = categoryColors[def.category] || "bg-gray-500";
  const textColor = def.category === BlockCategory.EVENT ? "text-yellow-900" : "text-white";

  const renderIcon = () => {
    const size = 18;
    switch (type) {
      case BlockType.MOVE_RIGHT: return <ArrowRight size={size} strokeWidth={3} />;
      case BlockType.MOVE_LEFT: return <ArrowLeft size={size} strokeWidth={3} />;
      case BlockType.MOVE_UP: return <ArrowUp size={size} strokeWidth={3} />;
      case BlockType.MOVE_DOWN: return <ArrowDown size={size} strokeWidth={3} />;
      case BlockType.REPEAT_2: return <Repeat size={size} strokeWidth={3} />;
      case BlockType.REPEAT_3: return <Repeat size={size} strokeWidth={3} />;
      case BlockType.REPEAT_UNTIL: return <Flag size={size} strokeWidth={3} />;
      case BlockType.PAINT: return <Brush size={size} strokeWidth={3} />;
      case BlockType.START: return <Play size={size} strokeWidth={3} fill="currentColor" />;
      case BlockType.IF_OBSTACLE: return <Split size={size} strokeWidth={3} />;
      case BlockType.IF_PATH: return <GitBranch size={size} strokeWidth={3} />;
      case BlockType.ELSE_IF: return <GitMerge size={size} strokeWidth={3} />;
      case BlockType.ELSE: return <CornerDownRight size={size} strokeWidth={3} />;
      default: return null;
    }
  };

  return (
    <div className={`
      relative flex items-center gap-2 px-3 py-2 rounded-lg font-bold select-none
      border-b-4 active:border-b-0 transition-all
      ${colorClass} ${textColor} ${className}
    `}>
      {/* Visual de Encaixe de Cima (Macho) */}
      <div className="absolute top-[-5px] left-6 w-5 h-2.5 bg-inherit rounded-t-full md:block hidden opacity-80" />
      
      {/* Visual de Encaixe de Baixo (FÃªmea) */}
      <div className="absolute bottom-[-5px] left-6 w-5 h-2.5 bg-black/20 rounded-t-full md:block hidden" />

      <span className="shrink-0">{renderIcon()}</span>
      {showLabel && <span className="text-[10px] md:text-sm whitespace-nowrap overflow-hidden text-ellipsis">{def.label}</span>}
    </div>
  );
};
